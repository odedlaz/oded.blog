---
title: open dropbox & shit
tags: []
categories: []
date: 2017-07-30 14:58:48
---

```bash
#!/usr/bin/env fish

set filename $argv[1]

if not test -n "$filename"
   echo "you have to pass a filename"
   exit 1
end

set filename (readlink -f "$filename")
if not test -e "$filename"
   echo "'"(basename $filename)"' doesn't exist"
   exit 1
end

set ext (echo "$filename" | awk -F . '{print $NF}')
if not contains "$ext" "docx" "doc" "ppt" "pptx" "xls" "xlsx"
   echo "\".$ext\" extension is not supported"
   exit 1
end

set relpath (realpath --relative-to="$HOME/Dropbox" "$filename")
if echo "$relpath" | grep "\.\." > /dev/null
   # open with google-extension
   google-chrome "$filename"
   exit 0
end


set base_url "https://www.dropbox.com/home"
set msft_base_url = "https://www.dropbox.com/ow/msft/edit/home"

set dropbox_url "$base_url/"(dirname $relpath)"?preview="(basename $filename)

google-chrome "$dropbox_url" > /dev/null ^&1
```
